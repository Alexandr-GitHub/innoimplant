# Документация компонента ListMore

## Обзор
Компонент `ListMore` реализует адаптивный список с кнопкой "Еще", которая скрывает переполненные элементы в выпадающий список. Поддерживает автоматическое обнаружение контейнера, динамическое изменение при ресайзе и кросс-браузерную работу через `ResizeObserver`.
---

## Использование

### Базовый пример

```pug
+ListMore([
    { href: '/link1', text: 'Пункт 1' },
    { href: '/link2', text: 'Пункт 2' },
    { href: '/link3', text: 'Пункт 3' }
], 'Ещё')
```

**Результирующий HTML:**

```html
<nav class="ns-list-more">
    <ul class="ns-list-more__list">
        <li><a href="/link1">Пункт 1</a></li>
        <li><a href="/link2">Пункт 2</a></li>
        <li><a href="/link3">Пункт 3</a></li>
    </ul> 
    <button class="ns-list-more__btn" aria-label="Ещё"> Ещё <svg>...</svg> </button>
    <ul class="ns-list-more__droplist"></ul>
</nav>
```

* * *

## Параметры

### PUG-миксина

| Параметр | Тип | Описание |
|----------|-----|----------|
| `links` | `array` | Массив объектов с `href` и `text` |
| `moreText` | `string` | Текст на кнопке (по умолчанию: 'Ещё') |

* * *

### JS-конструктор

```js
new ListMore({
    parent: container,
    items: document.querySelectorAll('.ns-list-more__list > li'),
    btn: document.querySelector('.ns-list-more__btn'),
    dropList: document.querySelector('.ns-list-more__droplist'),
    maxVisible: 4,
    classList: {
        dropped: 'ns-list-more--dropped'
    }
});
```

Но в `ns-global.js` - это вызывается по умолчанию и следит за всеми элементами с этими классами.

| Параметр | Тип | Описание |
|----------|-----|----------|
| `parent` | `Node` | Контейнер компонента |
| `items` | `NodeList` | Список элементов для отслеживания |
| `btn` | `Node` | Кнопка "Еще" |
| `dropList` | `Node` | Выпадающий список |
| `maxVisible` | `number` | Максимальное количество видимых элементов (по умолчанию: `null`) |
| `classList` | `object` | CSS-классы состояний (`dropped` по умолчанию) |


* * *

## Состояния

| Класс состояния | Применяется к |
|-----------------|---------------|
| `.ns-list-more--dropped` | Активное состояние выпадающего списка |
| `.ns-list-more__droplist` | Контейнер скрытых элементов |

* * *

## JavaScript-функциональность

### Основные методы

- **`calculate()`** — вычисляет видимость элементов на основе ширины контейнера.
- **`toggleDropList()`** — переключает состояние выпадающего списка.
- **`observe()`** — использует `ResizeObserver` для реакции на изменения размеров.

### События

- **`click` на кнопке** — открывает/закрывает выпадающий список.
- **`click` вне контейнера** — закрывает выпадающий список.

* * *

## Доступность

- Кнопка имеет `aria-label` и поддерживает фокус клавиатурой.
- Выпадающий список скрывается при клике вне области.
- Иконка кнопки поворачивается при активации.

* * *

## Примечания

1. Компонент автоматически определяет, какие элементы не помещаются в контейнер.
2. Для корректной работы требуется вызвать `initListMore()` после загрузки DOM. 
    > [!NOTE]
    > В `ns-global.js` - это делается автоматически
3. Используйте `maxVisible` для принудительного ограничения видимых элементов.
4. В стилях задан `clip-path`, чтобы избежать переполнения контента.
5. Поддерживается анимация открытия/закрытия выпадающего списка.
6. Не забудьте подключить миксин `icon` для отображения иконки стрелки.